<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CBR Garage OS</title>

<style>
body{
  font-family: Arial, sans-serif;
  background:#0a0a0a;
  color:white;
  margin:0;
  padding:10px;
  font-size:18px;
}

h1{
  text-align:center;
  font-style:italic;
  font-size:32px;
  color:red;
  letter-spacing:3px;
  margin-bottom:10px;
}

.section{
  background:#111;
  margin:15px auto;
  padding:15px;
  border-radius:12px;
  border:1px solid #222;
}

h2{
  margin-top:0;
  font-size:20px;
  border-left:5px solid red;
  padding-left:8px;
}

input,select,button{
  width:100%;
  font-size:18px;
  padding:12px;
  margin:8px 0;
  border-radius:8px;
  border:none;
}

button{
  background:red;
  color:white;
  font-weight:bold;
}

button:active{
  transform:scale(0.97);
}

.low{ color:red; font-weight:bold; }

.alertBar{
  background:red;
  padding:10px;
  text-align:center;
  font-weight:bold;
  margin-bottom:10px;
  border-radius:8px;
}

.part{color:#ff4d4d;}
.chemical{color:#bb66ff;}
.oil{color:#3399ff;}
.consume{color:#ffaa33;}

ul{
  list-style:none;
  padding:0;
}

li{
  padding:8px 0;
  border-bottom:1px solid #222;
}

img{
  max-width:100%;
  border-radius:10px;
  margin-top:10px;
}
</style>
</head>

<body>

<h1>CBR GARAGE OS</h1>

<div id="alertArea"></div>

<div class="section">
<h2>ğŸ ãƒã‚¤ã‚¯ç”»åƒ</h2>
<input type="file" id="bikeImage">
<img id="preview">
</div>

<div class="section">
<h2>ğŸ“Š èµ°è¡Œè·é›¢</h2>
ç¾åœ¨èµ°è¡Œè·é›¢ (km)
<input type="number" id="currentKm">
<button onclick="saveCurrentKm()">ä¿å­˜</button>
<p id="maintenanceStatus"></p>
</div>

<div class="section">
<h2>ğŸ”§ ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹è¨˜éŒ²</h2>
<select id="maintType">
  <option value="oil">ã‚ªã‚¤ãƒ«</option>
  <option value="chain">ãƒã‚§ãƒ¼ãƒ³</option>
  <option value="pad">ãƒ–ãƒ¬ãƒ¼ã‚­ãƒ‘ãƒƒãƒ‰</option>
  <option value="fluid">ãƒ–ãƒ¬ãƒ¼ã‚­ãƒ•ãƒ«ãƒ¼ãƒ‰</option>
</select>
å‰å›äº¤æ›è·é›¢ (km)
<input type="number" id="maintKm">
<button onclick="saveMaintenance()">è¨˜éŒ²</button>
</div>

<div class="section">
<h2>ğŸ“¦ åœ¨åº«ç®¡ç†</h2>
<select id="category">
  <option value="part">éƒ¨å“</option>
  <option value="chemical">ã‚±ãƒŸã‚«ãƒ«</option>
  <option value="oil">ã‚ªã‚¤ãƒ«</option>
  <option value="consume">æ¶ˆè€—å“</option>
</select>
å“å
<input type="text" id="name">
æ•°é‡
<input type="number" id="qty">
<button onclick="addItem()">è¿½åŠ </button>
<ul id="list"></ul>
</div>

<script>
let items = JSON.parse(localStorage.getItem("garageItems")) || [];
let maintenance = JSON.parse(localStorage.getItem("maintenance")) || {};
let currentKm = localStorage.getItem("currentKm") || 0;

const intervals = {
  oil:3000,
  chain:1000,
  pad:5000,
  fluid:10000
};

function typeName(t){
  return {
    oil:"ã‚ªã‚¤ãƒ«",
    chain:"ãƒã‚§ãƒ¼ãƒ³",
    pad:"ãƒ–ãƒ¬ãƒ¼ã‚­ãƒ‘ãƒƒãƒ‰",
    fluid:"ãƒ–ãƒ¬ãƒ¼ã‚­ãƒ•ãƒ«ãƒ¼ãƒ‰"
  }[t];
}

function saveCurrentKm(){
  currentKm=document.getElementById("currentKm").value;
  localStorage.setItem("currentKm",currentKm);
  checkMaintenance();
}

function saveMaintenance(){
  const type=document.getElementById("maintType").value;
  const km=document.getElementById("maintKm").value;
  maintenance[type]=km;
  localStorage.setItem("maintenance",JSON.stringify(maintenance));
  checkMaintenance();
}

function checkMaintenance(){
  let status="";
  let alertMsg="";
  for(let type in intervals){
    if(maintenance[type]){
      let next=parseInt(maintenance[type])+intervals[type];
      let remain=next-currentKm;
      status+= typeName(type)+" æ¬¡å›:"+next+"km / ";
      if(remain<=0){
        alertMsg+= typeName(type)+" äº¤æ›æ™‚æœŸã§ã™ï¼ ";
      }else{
        status+="æ®‹ã‚Š"+remain+"km<br>";
      }
    }
  }
  document.getElementById("maintenanceStatus").innerHTML=status;
  document.getElementById("alertArea").innerHTML=
    alertMsg ? "<div class='alertBar'>âš  "+alertMsg+"</div>" : "";
}

function saveItems(){
  localStorage.setItem("garageItems",JSON.stringify(items));
}

function render(){
  const list=document.getElementById("list");
  list.innerHTML="";
  items.forEach((item,i)=>{
    const li=document.createElement("li");
    li.className=item.category;
    li.innerHTML=item.name+" : "+
    (item.qty<=1?"<span class='low'>"+item.qty+" âš </span>":item.qty)
    +" <button onclick='removeItem("+i+")'>å‰Šé™¤</button>";
    list.appendChild(li);
  });
}

function addItem(){
  const category=document.getElementById("category").value;
  const name=document.getElementById("name").value;
  const qty=parseInt(document.getElementById("qty").value);
  if(!name||!qty)return;
  items.push({category,name,qty});
  saveItems();
  render();
}

function removeItem(i){
  items.splice(i,1);
  saveItems();
  render();
}

document.getElementById("bikeImage").addEventListener("change",function(e){
  const reader=new FileReader();
  reader.onload=function(){
    document.getElementById("preview").src=reader.result;
    localStorage.setItem("bikeImage",reader.result);
  }
  reader.readAsDataURL(e.target.files[0]);
});

const savedImage=localStorage.getItem("bikeImage");
if(savedImage){
  document.getElementById("preview").src=savedImage;
}

document.getElementById("currentKm").value=currentKm;
render();
checkMaintenance();
</script>

</body>
</html>
