<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Garage CBR</title>
<style>
body{
  font-family: Arial;
  background:#111;
  color:white;
  text-align:center;
}

h1{
  font-style:italic;
  font-size:28px;
  letter-spacing:2px;
  color:red;
}

select,input,button{
  padding:8px;
  margin:5px;
  border-radius:5px;
  border:none;
}

button{
  background:red;
  color:white;
  font-weight:bold;
}

.low{
  color:red;
  font-weight:bold;
}

.part{color:#ff4d4d;}
.chemical{color:#bb66ff;}
.oil{color:#3399ff;}
.consume{color:#ffaa33;}

img{
  max-width:90%;
  margin:10px;
  border-radius:10px;
}
</style>
</head>

<body>

<h1>CBR GARAGE</h1>

<input type="file" id="bikeImage">
<br>
<img id="preview">

<hr>

<select id="category">
  <option value="part">部品</option>
  <option value="chemical">ケミカル</option>
  <option value="oil">オイル</option>
  <option value="consume">消耗品</option>
</select>

<input type="text" id="name" placeholder="品名">
<input type="number" id="qty" placeholder="数量">
<button onclick="addItem()">追加</button>

<ul id="list"></ul>

<script>
let items = JSON.parse(localStorage.getItem("garageItems")) || [];

function save(){
  localStorage.setItem("garageItems", JSON.stringify(items));
}

function render(){
  const list = document.getElementById("list");
  list.innerHTML="";
  items.forEach((item,i)=>{
    const li=document.createElement("li");
    li.className=item.category;
    li.innerHTML = item.name + " : " + 
      (item.qty<=1 ? "<span class='low'>"+item.qty+" ⚠</span>" : item.qty)
      + " <button onclick='removeItem("+i+")'>削除</button>";
    list.appendChild(li);
  });
}

function addItem(){
  const category=document.getElementById("category").value;
  const name=document.getElementById("name").value;
  const qty=parseInt(document.getElementById("qty").value);
  if(!name||!qty)return;
  items.push({category,name,qty});
  save();
  render();
}

function removeItem(i){
  items.splice(i,1);
  save();
  render();
}

document.getElementById("bikeImage").addEventListener("change",function(e){
  const reader=new FileReader();
  reader.onload=function(){
    document.getElementById("preview").src=reader.result;
    localStorage.setItem("bikeImage",reader.result);
  }
  reader.readAsDataURL(e.target.files[0]);
});

const savedImage=localStorage.getItem("bikeImage");
if(savedImage){
  document.getElementById("preview").src=savedImage;
}

render();
</script>

</body>
</html>
